<!-- <div id="forms" class="page-layout simple fullwidth" fxLayout="column"> -->

<!-- HEADER -->
<!-- <div class="header accent p-24 h-60" fxLayout="row" fxLayoutAlign="start center">
        <div fxLayout="column" fxLayoutAlign="center start">
            <div class="h2 mt-16">Guardar usuario</div>
        </div>
    </div> -->
<!-- / HEADER -->

<!-- CONTENT -->
<!-- <div class="content p-24"> -->
<ngx-spinner type="timer"></ngx-spinner>
<div class="mb-24" fxLayout="column" fxLayoutAlign="start" fxLayout.gt-md="row">

    <!-- REACTIVE FORM EXAMPLE -->
    <!-- nIdUsuario
            cLogin
            cNombre
            cApellidoPaterno
            cApellidoMaterno
            cPassword -->


    <form class="mat-card mat-elevation-z4" fxLayout="column" fxLayoutAlign="start" fxFlex="1 0 auto" name="form"
        [formGroup]="form">

        <div class="h2 mb-24">Usuario</div>

        <div fxLayout="row wrap" fxLayoutAlign="start center" fxFlex="1 0 auto">

            <mat-form-field appearance="outline" fxFlex="80" class="pl-4">
                <mat-label>Usuario</mat-label>
                <input matInput formControlName="usuario" required minlength="3" maxlength="100">
                <mat-icon matSuffix class="secondary-text">person</mat-icon>
                <mat-error *ngIf="form.get('usuario').hasError('required')">El nombre de usuario es requerido
                </mat-error>
                <mat-error
                    *ngIf="form.get('usuario').hasError('minlength') || form.get('usuario').hasError('maxlength')">Valor
                    invalido, el mínimo de caracteres es 3 y el máximo son 100 </mat-error>
            </mat-form-field>

            <div fxLayout="row" fxLayoutAlign="start center" fxFlex="10">
                <mat-label class="example-margin">Estatus</mat-label>
                <mat-radio-group fxLayout="column" fxLayoutAlign="start start">
                    <mat-checkbox class="example-margin" formControlName="estatus" (click)="validaEstatus()">
                    </mat-checkbox>
                </mat-radio-group>
                <!-- 
                <mat-label class="example-margin">Administrador</mat-label>
                <mat-radio-group fxLayout="column" fxLayoutAlign="start start">
                    <mat-checkbox class="example-margin" formControlName="administrador"></mat-checkbox>
                </mat-radio-group> -->
                <!-- Image Preview -->
            </div>
            <!-- <div fxLayout="row" fxLayoutAlign="start center" fxFlex="20">
            </div> -->
            <!-- <div class="contenedor-imagen" *ngIf="!imageURL">
                <img src="../../../../assets/images/avatars/profile.jpg">
            </div> -->



        </div>
        <div fxLayout="row" fxLayoutAlign="start center" fxFlex="1 0 auto">

            <mat-form-field appearance="outline" fxFlex="50" class="pl-4">
                <mat-label>Contraseña</mat-label>
                <input matInput type="text" formControlName="password" required autocomplete="off"
                    [ngClass]="{'pw': this.type === 'password'}">
                <mat-icon *ngIf="this.type ==='password'" matSuffix class="secondary-text" (click)="viewPassword()">
                    visibility</mat-icon>
                <mat-icon *ngIf="this.type !=='password'" matSuffix class="secondary-text" (click)="viewPassword()">
                    visibility_off</mat-icon>
                <mat-error *ngIf="form.get('password').hasError('required')">La contraseña es requerida</mat-error>
                <mat-error *ngIf="form.get('password').hasError('minlength')">Valor invalido, el mínimo de caracteres es
                    3 y el máximo son 100 </mat-error>
                <mat-error *ngIf="!form.get('password').hasError('required') &&
                    form.get('password').hasError('passwordsNotMatching')">
                    Las contraseñas deben coincidir
                </mat-error>

            </mat-form-field>

            
            <mat-form-field appearance="outline" fxFlex="50" class="pl-4">
                <mat-label>Confirmación de contraseña</mat-label>
                <input matInput type="text" formControlName="passwordConfirm" required autocomplete="off"
                    [ngClass]="{'pw': this.type === 'password'}">
                <mat-icon *ngIf="this.type ==='password'" matSuffix class="secondary-text" (click)="viewPassword()">
                    visibility</mat-icon>
                <mat-icon *ngIf="this.type !=='password'" matSuffix class="secondary-text" (click)="viewPassword()">
                    visibility_off</mat-icon>
                <mat-error *ngIf="form.get('passwordConfirm').hasError('required')">La contraseña es requerida
                </mat-error>
                <mat-error *ngIf="!form.get('passwordConfirm').hasError('required') &&
                                   form.get('passwordConfirm').hasError('passwordsNotMatching')">
                    Las contraseñas deben coincidir
                </mat-error>

            </mat-form-field>

          

            <!--   <button mat-raised-button appearance="outline" fxFlex="50" color="accent" (click)="add()">Seleccionar imagen
                de perfil
                <mat-icon>add</mat-icon>
            </button> -->
            <input id="file" #fileInput type="file" accept="image/png,image/jpeg,image/jpg"
                (change)="showPreview($event)" style="display:none;">

        </div>
        <div fxLayout="row" fxLayoutAlign="start center" fxFlex="100" class="pl-4">
            <mat-error class="pl-4" *ngIf="form.get('password').hasError('pattern')">La contraseña debe contener
                mínimo: 9
                caracteres, 1 mayúscula, 1 minúscula, 1 caracter especial (@#$%¡¿_:;=?&-).</mat-error>
        </div>
        <div fxLayout="row" fxLayoutAlign="start center" fxFlex="1 0 auto">


            <div fxLayout="row" fxLayoutAlign="start center" fxFlex="15">

            </div>


        </div>

        
        <div fxLayout="row" fxLayoutAlign="start center" fxFlex="100" class="pl-4">
            <mat-error class="pl-4" *ngIf="form.get('passwordConfirm').hasError('pattern')">La contraseña debe contener
                mínimo: 9
                caracteres, 1 mayúscula, 1 minúscula, 1 caracter especial (@#$%¡¿_:;=?&-).</mat-error>
        </div>
        <div fxLayout="row" fxLayoutAlign="start center" fxFlex="1 0 auto">

            <mat-form-field appearance="outline" fxFlex="100" class="pr-4">
                <mat-label>Nombre (s)</mat-label>
                <input matInput formControlName="nombre" required>
                <mat-icon matSuffix class="secondary-text">account_circle</mat-icon>
                <mat-error *ngIf="form.get('nombre').hasError('required')">El nombre es requerido</mat-error>
                <mat-error
                    *ngIf="form.get('nombre').hasError('minlength') || form.get('primerApellido').hasError('maxlength')">
                    Valor invalido, el mínimo de caracteres es 3 y el máximo son 100 </mat-error>

            </mat-form-field>

            <!--      <mat-form-field appearance="outline" fxFlex="50">
                <mat-label>Entes *</mat-label>
                <mat-select formControlName="secretarias" [(ngModel)]="selectedSecretaria" name="secretarias">
                    <mat-option *ngFor="let secretaria of arrSecretarias" [value]="secretaria.id">
                        {{secretaria.cDescripcionSecretaria}}
                    </mat-option>
                </mat-select>
                <mat-error>El ente es requerido</mat-error>

            </mat-form-field> -->

        </div>

        <div fxLayout="row" fxLayoutAlign="start center" fxFlex="1 0 auto">

            <mat-form-field appearance="outline" fxFlex="100" class="pl-4">
                <mat-label>Primer apellido</mat-label>
                <input matInput formControlName="primerApellido" required>
                <mat-icon matSuffix class="secondary-text">account_circle</mat-icon>

                <mat-error *ngIf="form.get('primerApellido').hasError('required')">El apellido es requerido</mat-error>
                <mat-error
                    *ngIf="form.get('primerApellido').hasError('minlength') || form.get('primerApellido').hasError('maxlength')">
                    Valor invalido, el mínimo de caracteres es 3 y el máximo son 100 </mat-error>

            </mat-form-field>



            <!--     <mat-form-field appearance="outline" fxFlex="50">
                <mat-label *ngIf="this.arrDirecciones.length > 0">Entidades *</mat-label>
                <mat-label *ngIf="this.arrDirecciones.length === 0">Entidades</mat-label>
                <mat-select formControlName="direcciones" [(ngModel)]="selectedDireccion" name="direcciones">
                    <mat-option *ngFor="let direccion of arrDirecciones" [value]="direccion.id">
                        {{direccion.cDescripcionDireccion}}
                    </mat-option>
                </mat-select>
                <mat-error>La entidades son requerida</mat-error>

            </mat-form-field> -->
        </div>

        <div fxLayout="row" fxLayoutAlign="start center" fxFlex="1 0 auto">
            <mat-form-field appearance="outline" fxFlex="100" class="pl-4">
                <mat-label>Segundo apellido</mat-label>
                <input matInput formControlName="segundoApellido">
                <mat-icon matSuffix class="secondary-text">account_circle</mat-icon>
                <mat-error>El segundo apellido es requerido</mat-error>
            </mat-form-field>
            <!-- 
            <mat-form-field appearance="outline" fxFlex="50">
                <mat-label *ngIf="this.arrDepartamentos.length > 0 && this.arrDirecciones.length > 0">Dependencia *
                </mat-label>
                <mat-label *ngIf="this.arrDepartamentos.length === 0 || this.arrDirecciones.length === 0">Dependencia
                </mat-label>
                <mat-select formControlName="departamentos" [(ngModel)]="selectedDepartamento" name="departamentos">
                    <mat-option *ngFor="let departamento of arrDepartamentos" [value]="departamento.id">
                        {{departamento.cDescripcionDepartamento}}
                    </mat-option>
                </mat-select>
                <mat-error *ngIf="form.get('departamentos').hasError('required')">La dependencia es requerida
                </mat-error>
            </mat-form-field> -->

        </div>

        <div fxLayout="row" fxLayoutAlign="start center" fxFlex="1 0 auto">
            <mat-form-field appearance="outline" fxFlex="100" class="pl-4">
                <mat-label>E-mail *</mat-label>
                <input matInput formControlName="correo">
                <mat-icon matSuffix class="secondary-text">email</mat-icon>
                <mat-error *ngIf="form.get('correo').hasError('required')">El E-Mail es requerido</mat-error>
                <mat-error *ngIf="form.get('correo').hasError('pattern')">Introduzca un E-Mail válido</mat-error>
            </mat-form-field>





        </div>

        <div fxLayout="row" fxLayoutAlign="start center" fxFlex="1 0 auto">



            <mat-form-field appearance="outline" fxFlex="100" class="pl-4">
                <mat-label>Telefono *</mat-label>
                <input matInput formControlName="telefono">
                <mat-icon matSuffix class="secondary-text">phone</mat-icon>
                <mat-error *ngIf="form.get('telefono').hasError('required')">El teléfono es requerido</mat-error>

            </mat-form-field>

        </div>
        <!--    <div fxLayout="row" fxLayoutAlign="start center" fxFlex="1 0 auto">
            <mat-form-field appearance="outline" fxFlex="50" class="pl-4">
                <mat-label>Empleado</mat-label>
                <mat-select formControlName="empleado" [(ngModel)]="selectedEmpleado" name="empleado">
                    <mat-option *ngFor="let empleado of arrEmpleados" [value]="empleado.id">
                        {{empleado.nombre + ' ' + empleado.apellidoPaterno + ' ' + empleado.apellidoMaterno }}
                    </mat-option>
                </mat-select>
            </mat-form-field>

        </div> -->

    </form>

</div>

<div *ngIf="this.usuario.bActivo">
    <mat-form-field>

        <mat-label>Buscar</mat-label>
        <input type='text' matInput placeholder='' (keyup)='filterUsuarios($event)'>

    </mat-form-field>

    <mat-icon class="buscar">search</mat-icon>
    Seleccionar todos
    <mat-checkbox class="example-margin" [(ngModel)]="selectedUsuarios" (click)="seleccionarUsuarios()">
    </mat-checkbox>
    <ngx-datatable class="material" [rows]="rows" [loadingIndicator]="loadingIndicator" [columnMode]="'force'"
        [headerHeight]="30" [footerHeight]="35" [rowHeight]="'auto'" [scrollbarH]="true" [reorderable]="reorderable"
        [limit]="5" style="height: 350px;">
        <ngx-datatable-column name="Perfil de Usuario" prop="cNombrePerfil"></ngx-datatable-column>
        <ngx-datatable-column name="Añadir" sortable="false" prop="id">
            <ng-template let-row="row" let-value="value" ngx-datatable-cell-template>
                <mat-checkbox class="example-margin" [(ngModel)]="row.Agregar">
                </mat-checkbox>
            </ng-template>
        </ngx-datatable-column>
    </ngx-datatable>



</div>

<!-- <div class="padding" >
    <mat-form-field>
        <mat-label>Buscar</mat-label>
        <input type='text' matInput placeholder='' (keyup)='filterPermiso($event)'>

    </mat-form-field>

    <mat-icon class="buscar">search</mat-icon>
    Seleccionar todos
    <mat-checkbox class="example-margin" [(ngModel)]="selectedPermiso" (click)="seleccionaPermiso()">
    </mat-checkbox>
    <ngx-datatable class="material" [rows]="rowsPermisos" [loadingIndicator]="loadingIndicator" [columnMode]="'force'"
        [headerHeight]="30" [footerHeight]="35" [rowHeight]="'auto'" [scrollbarH]="true" [reorderable]="reorderable"
        [limit]="12" >
        <ngx-datatable-column name="Permiso" prop="permiso"></ngx-datatable-column>
        <ngx-datatable-column name="Añadir" sortable="false" prop="id">
            <ng-template let-row="row" let-value="value" ngx-datatable-cell-template>
                <mat-checkbox class="example-margin" [(ngModel)]="row.Agregar">
                </mat-checkbox>
            </ng-template>
        </ngx-datatable-column>
    </ngx-datatable>



</div> -->
<mat-dialog-actions align="end">
    <button mat-raised-button color="warn" (click)="cerrar(true)">Cerrar</button>
    <button [disabled]="form.invalid || this.passNoIgual" mat-raised-button color="accent"
        (click)="guardar()">Guardar</button>
</mat-dialog-actions>
<!-- </div> -->
<!-- / CONTENT -->

<!-- </div> -->