<ngx-spinner></ngx-spinner>
<div class="modal" fxLayout="column" fxLayoutAlign="start" fxLayout.gt-md="row">
    <!-- REACTIVE FORM EXAMPLE -->


    <form class="mat-card mat-elevation-z4" fxLayout="column" fxLayoutAlign="start" fxFlex="1 0 auto" name="form" [formGroup]="form">


        <div layout="row">
            <div fxFlex="90">
                <div class="h2 mb-24">Turno</div>
            </div>
            <div fxFlex="10">
                <button *ngIf="this.iniciativa.formatosTipoIniciativa.length > 0" mat-raised-button color="warn" align="end" (click)="clasificarDocumento()">Vista
                    previa</button>
            </div>

        </div>
        <div fxLayout="row" fxLayoutAlign="start center" fxFlex="30">
            <mat-form-field appearance="outline" fxFlex="1 0 auto" class="pl-4">
                <mat-label>Tipo</mat-label>
                <mat-select formControlName="tipo" [(ngModel)]="selectTipo" name="tipo">
                    <mat-option *ngFor="let tipo of arrTipo" [value]="tipo.id">
                        {{tipo.descripcion}}
                    </mat-option>
                </mat-select>
                <mat-error>El tipo de iniciativa es requerido</mat-error>
            </mat-form-field>
            <mat-form-field appearance="outline" fxFlex="1 0 auto" class="pl-4">
                <mat-label>Estatus</mat-label>
                <input matInput formControlName="estatus">
                <mat-icon matSuffix class="secondary-text">insert_drive_file</mat-icon>

            </mat-form-field>
        </div>
        <div fxLayout="row" fxLayoutAlign="start center" fxFlex="30">

            <mat-form-field appearance="outline" fxFlex="1 0 auto" class="pl-4">
                <mat-label>Folio</mat-label>
                <input matInput formControlName="id">
                <mat-icon matSuffix class="secondary-text">insert_drive_file</mat-icon>

            </mat-form-field>
            <mat-form-field appearance="outline" fxFlex="1 0 auto" class="pl-4">
                <mat-label>Fecha de turno</mat-label>
                <input matInput [matDatepicker]="picker2" formControlName="fechaRegistro" [max]="maxDate">
                <mat-datepicker-toggle matSuffix [for]="picker2"></mat-datepicker-toggle>
                <mat-datepicker #picker2></mat-datepicker>
                <mat-error>La fecha del registro no es valida ej. 28/11/2020</mat-error>

            </mat-form-field>

        </div>

        <div fxLayout="row" fxLayoutAlign="start center" fxFlex="1 0 auto">

            <mat-form-field appearance="outline" fxFlex="30" class="pl-4">
                <mat-label>Fecha de iniciativa</mat-label>
                <input matInput [matDatepicker]="picker1" formControlName="fechaIniciativa" [max]="maxDate">
                <mat-datepicker-toggle matSuffix [for]="picker1"></mat-datepicker-toggle>
                <mat-datepicker #picker1></mat-datepicker>
                <mat-error>La fecha de la iniciativa no es valida ej. 28/11/2020</mat-error>

            </mat-form-field>

        </div>
        <mat-form-field>
            <mat-label>Autor (s)</mat-label>
            <mat-chip-list #chipList [disabled]="true" aria-label="Selección de autores">
                <mat-chip *ngFor="let autor of autores" [selectable]="selectable" [removable]="removable" (removed)="eliminarAutor(autor)">
                    {{autor.name}}
                    <mat-icon matChipRemove *ngIf="removable">cancel</mat-icon>
                </mat-chip>
                <input matInput formControlName="autores" placeholder="Nuevo autor..." [matChipInputFor]="chipList" [matChipInputSeparatorKeyCodes]="separatorKeysCodes" [matChipInputAddOnBlur]="addOnBlur" (matChipInputTokenEnd)="agregarAutor($event)" disabled>
            </mat-chip-list>
        </mat-form-field>
        <mat-form-field class="example-chip-list">
            <mat-label>Tema</mat-label>
            <mat-chip-list [disabled]="true" #chipList2 aria-label="Selección de temas">
                <mat-chip [disabled]="true" *ngFor="let tema of temas" [selectable]="selectable2" [removable]="removable2" (removed)="eliminarTema(tema)">
                    {{tema.name}}
                    <mat-icon matChipRemove *ngIf="removable2">cancel</mat-icon>
                </mat-chip>
                <input matInput [disabled]="true" formControlName="tema" placeholder="Nuevo tema..." [matChipInputFor]="chipList2" [matChipInputSeparatorKeyCodes]="separatorKeysCodes" [matChipInputAddOnBlur]="addOnBlur2" (matChipInputTokenEnd)="agregarTema($event)" disabled>
            </mat-chip-list>
        </mat-form-field>
        <mat-form-field class="example-chip-list" *ngIf="iniciativa.estatus==='Turnado de iniciativa a comisión'">
            <mat-label>Clasificación de iniciativa</mat-label>
            <mat-chip-list #chipList3 aria-label="Selección de clasificaciones">
                <mat-chip *ngFor="let clasificacion of clasificaciones" [selectable]="selectable3" [removable]="removable3" (removed)="eliminarClasificacion(clasificacion)">
                    {{clasificacion.name}}
                    <mat-icon matChipRemove *ngIf="removable3">cancel</mat-icon>
                </mat-chip>
                <input matInput formControlName="tema" placeholder="Nueva clasificación..." [matChipInputFor]="chipList3" [matChipInputSeparatorKeyCodes]="separatorKeysCodes" [matChipInputAddOnBlur]="addOnBlur3" (matChipInputTokenEnd)="agregarClasificacion($event)">
            </mat-chip-list>
        </mat-form-field>

        <div fxLayout="row" fxLayoutAlign="start center" *ngIf="iniciativa.estatus==='Turnado de iniciativa a comisión'" fxFlex="1 0 auto">
            <mat-form-field appearance="outline" fxFlex="100">
                <mat-label>Comisión</mat-label>
                <mat-select formControlName="comision" [(ngModel)]="selectedComision" name="comision">
                    <mat-option *ngFor="let comision of comisiones" [value]="comision.id">
                        {{comision.descripcion}}
                    </mat-option>
                </mat-select>
                <mat-error>La comisión es requerida.</mat-error>
            </mat-form-field>
        </div>

        <div layout="row">
            <div fxFlex="90">
                <div class="h2 mb-24">Actas de sesión</div>
            </div>
        </div>

        <div fxLayout="row" fxLayoutAlign="start center" fxFlex="1 0 auto">
            <mat-form-field appearance="outline" fxFlex="100">
                <mat-label>Legislatura</mat-label>
                <mat-select formControlName="legislatura" [(ngModel)]="selectedLegislatura" name="comision">
                    <mat-option *ngFor="let legis of legislatura" [value]="legis.id">
                        {{legis.cLegislatura}}
                    </mat-option>
                </mat-select>
                <mat-error>La legislatura es requerida.</mat-error>
            </mat-form-field>
        </div>

        <div fxLayout="row" fxLayoutAlign="start center" fxFlex="1 0 auto">
            <mat-form-field appearance="outline" fxFlex="100">
                <mat-label>Tipo de sesión</mat-label>
                <mat-select formControlName="tipoSesion" [(ngModel)]="selectedSesion" name="tipoSesion">
                    <mat-option *ngFor="let tipo of tipoSesion" [value]="tipo.descripcion">
                        {{tipo.descripcion}}
                    </mat-option>
                </mat-select>
                <mat-error>El tipo de sesión es requerido.</mat-error>
            </mat-form-field>
        </div>

        <mat-form-field appearance="outline" fxFlex="1 0 auto" class="pl-4">
            <mat-label>Fecha de sesión</mat-label>
            <input matInput [matDatepicker]="picker" formControlName="fechaSesion">
            <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
            <mat-datepicker #picker></mat-datepicker>
            <mat-error>La fecha del registro no es valida ej. 28/11/2020</mat-error>
        </mat-form-field>

        <mat-form-field appearance="outline" fxFlex="1 0 auto" class="pl-4">
            <mat-label>Hora de sesión</mat-label>
            <input matInput type="time" atp-time-picker formControlName="horaSesion" />
            <mat-error>La hora del registro no es valida ej. 01:00</mat-error>
        </mat-form-field>

        <div *ngIf="iniciativa.estatus!=='Turnado de iniciativa a comisión'" fxLayout="row" fxLayoutAlign="center" fxFlex="1 0 auto">
            <mat-label>Oficio de envio de informe</mat-label>
        </div>
        <div *ngIf="iniciativa.estatus!=='Turnado de iniciativa a comisión'" fxLayout="row" fxLayoutAlign="center" fxFlex="1 0 auto">

            <section fxLayoutAlign="center">
                <button color="warn" (click)="addOficio()" mat-raised-button color="warn">
                    Anexar documento <mat-icon>add</mat-icon>
                 </button>
            </section>
            <input type="file" #fileOficio id="fileOficio" name="fileOficio" accept="application/pdf" style="display:none;" />

        </div>

        <div *ngIf="iniciativa.estatus!=='Turnado de iniciativa a comisión'" fxLayout="row" fxLayoutAlign="center" fxFlex="1 0 auto">
            <mat-label class="example-margin" (change)="changeOficio()">{{fileOficioName}} </mat-label>
        </div>
        <div *ngIf="iniciativa.estatus!=='Turnado de iniciativa a comisión'" fxLayout="row" fxLayoutAlign="center" fxFlex="1 0 auto">
            <mat-label>Informe de resultados a revisión de la cuenta publica</mat-label>
        </div>
        <div *ngIf="iniciativa.estatus!=='Turnado de iniciativa a comisión'" fxLayout="row" fxLayoutAlign="center" fxFlex="1 0 auto">
            <section fxLayoutAlign="center">
                <button color="warn" (click)="addInforme()" mat-raised-button color="warn">
                   Anexar documento <mat-icon>add</mat-icon>
                </button>
            </section>
            <input type="file" #fileInforme id="fileInforme" name="fileInforme" accept="application/pdf" style="display:none;" />

        </div>
        <div *ngIf="iniciativa.estatus!=='Turnado de iniciativa a comisión'" fxLayout="row" fxLayoutAlign="center" fxFlex="1 0 auto">
            <mat-label class="example-margin" (change)="changeInforme()">{{fileInformeName}} </mat-label>
        </div>
    </form>

</div>



<mat-dialog-actions align="end" class="buttons">

    <!-- <button mat-raised-button color="warn" (click)="generaReport()">Documento</button>-->
    <button mat-raised-button color="warn" (click)="cerrar('')">Cerrar</button>
    <button *ngIf="iniciativa.estatus==='Turnado de iniciativa a comisión'" [disabled]="form.invalid" mat-raised-button color="accent" (click)="guardar()">Guardar</button>
    <button *ngIf="iniciativa.estatus!=='Turnado de iniciativa a comisión'" [disabled]="form.invalid  || fileInformeName.length === 0 || fileOficioName.length === 0" mat-raised-button color="accent" (click)="guardar()">Guardar</button>
    <!--<button  mat-raised-button color="accent" (click)="clasificarDocumento()">Upload</button> -->
</mat-dialog-actions>